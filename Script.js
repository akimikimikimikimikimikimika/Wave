(()=>{let ce=(t)=>document.createElement(t),cd=(i,c,t)=>{let e=ce("div");if (i) sa(e,"id",i);if (c) sc(e,c);if (t) e.textContent=t;return e;},ap=(p,c)=>p.appendChild(c),apd=(p,i,c,t)=>ap(p,cd(i,c,t)),rc=c=>c.parentNode.removeChild(c),sa=(e,k,v)=>e.setAttribute(k,v),ra=(e,k)=>e.removeAttribute(k),ss=(e,c)=>sa(e,"style",c),sc=(e,c)=>{if (c) sa(e,"class",c);else ra(e,"class");},sas=(e,w)=>sa(e,"aria-selected",w?"true":"false"),sad=(e,w)=>sa(e,"aria-disabled",w?"true":"false"),ael=(e,t,l,o)=>e.addEventListener(t,l,o),html=document.documentElement;let status=new Proxy({touch:false,standalone:false,browser:null,save:false,sources:[],cId:{},current:[],hold:[],dark:false,menuShowed:false,controllerShowed:false },{set:(t,p,v)=>{t[p]=v;let c=[];c.push(t.dark?"dark":"light");if (t.standalone) c.push("standalone");if (t.touch) c.push("touch");if (t.browser!=null) c.push(t.browser.toLowerCase());sc(html,c.join(" "));},get:(o,p)=>{return o[p];}});(()=>{status.standalone=navigator.standalone===true||(/standalone=yes/).test(location.search);if (window.ApplePaySession) status.browser="Safari";if (window.chrome) status.browser="Chrome";if (window.sidebar) status.browser="Firefox";status.touch=ce().ontouchstart===null;})();let body=ce("body");let il=apd(body,"inputLayer");let pl=apd(body,"positionLayer");let wl=apd(body,"waveLayer");let tl=apd(body,"textLayer");let remove=(a,o)=>{var p=false;a.forEach((e,n)=>{if (p) a[n-1]=e;else if (e==o) p=true;});a.length--;return a;};let st=v=>{if (v==0) return "50%";else if (v>0) return `calc( 50% + ${v}px )`;else if (v<0) return `calc( 50% - ${-v}px )`;};let cir=(c,x,y,r)=>{let ct=cd(null,c);var td=0,o=false;let f=()=>ss(ct,`left:${st(x-r)};right:${st(-x-r)};top:${st(y-r)};bottom:${st(-y-r)};${td?`transition-duration:${td}s,${td}s,${td}s,${td}s,${td}s,0.5s;`:""}${o?"opacity:0;":""}`);let cdn=(x2,y2,r2)=>{if (typeof(x2)=="number") x=x2;if (typeof(y2)=="number") y=y2;if (typeof(r2)=="number") r=r2;else r=status.touch?30:10;f();};ct.coordinate=(x,y,r)=>{cdn(x,y,r);};let ani=(t,r2,c)=>{td=t;if (c) o=true;cdn(x,y,r2);};ct.animate=(t,r,c)=>{ani(t,r,c);};cdn(x,y,r);return ct;};let create=()=>{var int=null,u=false,T=0;let t=status.touch;let wv=()=>{let w=Math.hypot(wl.offsetWidth/2+Math.abs(o.x),wl.offsetHeight/2+Math.abs(o.y))*1.1-(t?30:10);let d=w/Lw(o.L)*T;let wave=ap(wl,cir("wave",o.x,o.y,t?30:10));setTimeout(()=>{wave.animate(d,w,true);},0);setTimeout(()=>{rc(wave);},d*1000);if (u) os();},os=w=>{u=false;T=60/Fw(o.F);if (w) wv();else clearInterval(int);int=setInterval(wv,T*1000);};let o=new Proxy({x:0,y:0,L:0,F:0,oscillating:false,hold:false,current:false,moving:false,id:null,node:ap(pl,cir("pointer",0,0)),oscillate:()=>{if (!int) {os(true);o.oscillating=true;}},stop:()=>{if (int) {o.oscillating=false;clearInterval(int);int=null;}},deinit:()=>{if (status.current.find(e=>e===o)) remove(status.current,o);o.current=false;o.cId=null;o.moving=false;o.stop();rc(o.node);remove(status.sources,o);}},{set:(t,p,v)=>{t[p]=v;switch (p) {case "x":case "y":t.node.coordinate(t.x,t.y);break;case "F":u=true;break;case "current":sc(t.node,"pointer"+(t.current?" selected":""));break;}if (t.hold) his.save();}});status.sources.push(o);return o;};let toggleHold=o=>{if (o.hold) {o.hold=false;remove(status.hold,o);his.save();o.current=false;if (!o.moving) o.deinit();}else {o.hold=true;status.hold.push(o);his.save();}};let currentReset=()=>{while (status.current.length) {status.current[0].current=false;status.current.shift();}};var toggleMenu=null;var toggleController=null;var toggleDarkMode=null;var tcq=null,tcb=null;let his={storage:false,save:()=>{let h=[];status.hold.forEach(o=>h.push([o.x,o.y,o.F,o.L]));let d={dark:status.dark,hold:h };if (his.storage) {try{localStorage.setItem("Wave",JSON.stringify(d));}catch(e){his.storage=false;}}}};(()=>{let p=(r,m,M,d)=>{var v=parseFloat(r);if (isNaN(v)) return d;else {if (m) if (v<m) v=m;if (M) if (v>M) v=M;return v;}};try{let ls=localStorage.getItem("Wave");his.storage=true;if (ls) {let o=JSON.parse(ls);status.dark=!!o.dark;if (o.hold) var h=Array.from(o.hold);else var h=[];h.forEach(e=>{let o=create();o.x=p(e[0],0,0,0);o.y=p(e[1],0,0,0);o.F=p(e[2],-1,1,0);o.L=p(e[3],-1,1,0);o.hold=true;status.hold.push(o);});}else {throw new Error("Error");}}catch(e){}})();let Lb=()=>Math.min(wl.offsetWidth,wl.offsetHeight)/6;let Fw=v=>90*(3**v);let Lw=v=>Lb()*(3**v);let Fr=c=>Math.log(c/90)/Math.log(3);let Lr=c=>Math.log(c/Lb())/Math.log(3);(()=>{var add=false;let createP=(id,x,y)=>{var int=null;let o=create();o.x=x;o.y=y;o.id=id;if (!add) currentReset();status.current.push(o);o.current=true;o.moving=true;status.sources.push(o);status.cId[id]=o;o.oscillate();return o;};let moveP=(id,x,y)=>{let o=status.cId[id];o.x=x;o.y=y;return o;};let removeP=(id)=>{let o=status.cId[id];o.id=null;delete status.cId[id];o.moving=false;if (!o.hold) {remove(status.current,o);o.deinit();}return o;};let catchHeld=(x,y,id)=>{let o=status.hold.find(e=>Math.hypot(x-e.x,y-e.y)<=(status.touch?30:10));if (o) {status.cId[id]=o;if (!add) currentReset();if (!status.current.find(v=>v===o)) status.current.push(o);o.current=true;o.id=id;o.moving=true;}return !!o;};let X=e=>e.clientX-(il.offsetWidth/2);let Y=e=>e.clientY-(il.offsetHeight/2);let f=e=>{if (id) {removeP(id);id=null;}e.preventDefault();};if (status.touch) {ael(il,"touchstart",e=>{removeStartup();if (e.touches.length>1) add=true;else if (status.current.length&&e.shiftKey) add=true;else add=false;Array.from(e.changedTouches).forEach(t=>{if (!catchHeld(X(t),Y(t),t.identifier)) createP(t.identifier,X(t),Y(t));});e.preventDefault();});ael(il,"touchmove",e=>{Array.from(e.changedTouches).forEach(t=>moveP(t.identifier,t.clientX-(il.offsetWidth/2),t.clientY-(il.offsetHeight/2)));e.preventDefault();});let tf=e=>{Array.from(e.changedTouches).forEach(t=>{removeP(t.identifier);});e.preventDefault();};ael(il,"touchend",tf);ael(il,"touchcancel",tf);}else {var id=null;ael(il,"mousedown",e=>{removeStartup();if (status.current.length&&e.shiftKey) add=true;else add=false;id=Number(new Date());if (!catchHeld(X(e),Y(e),id)) createP(id,X(e),Y(e));e.preventDefault();});ael(il,"mousemove",e=>{if (status.cId[id]) moveP(id,X(e),Y(e));e.preventDefault();});ael(il,"mouseup",f);ael(il,"mouseout",f);}ael(html,"keyup",e=>{switch (e.key) {case "h":let w=status.current.every(c=>c.hold);status.current.forEach(c=>{if (c.hold==w) toggleHold(c);});break;case "m":case "M":toggleMenu();break;case "d":case "D":toggleDarkMode();break;case "e":case "E":tcq();break;case "Delete":case "Backspace":case "Clear":status.current.filter(c=>!c.id).forEach(c=>toggleHold(c));break;}e.preventDefault();});})();let icon=apd(body,"icon","hidden");sa(icon,"role","button");sa(icon,"title","Show menu");let mc=apd(body,"menu","hidden");let menu=apd(mc);let mb=apd(body,"menu-backface","hidden");let sb=apd(body,"statusbar","hidden");(()=>{var uh=false;var ch=false;let t=status.touch?"touchend":"mouseup";let f=w=>{sas(h,false);sad(h,true);sad(e,true);sad(x,!w);sad(d,!w);if (w) {ch=status.current.length>0;if (ch) {uh=status.current.every(o=>!o.hold);status.current.forEach(o=>{if (!o.hold) toggleHold(o);});sas(h,!uh);sad(h,false);sad(e,false);}}else {if (status.controllerShowed) toggleController();if (ch) {if (uh) while (status.current.length) toggleHold(status.current[0]);uh=false;}ch=false;}status.menuShowed=w;[icon,mc,mb,sb].forEach(e=>sc(e,w?"":"hidden"));};toggleMenu=()=>{f(!status.menuShowed);};let x=apd(menu,null,null,"×");sa(x,"role","button");sa(x,"title","Close menu");sad(x,true);sas(x,false);ael(x,t,e=>{f(false);e.preventDefault();});ael(mb,"click",e=>{f(false);e.preventDefault();});ael(icon,t,e=>{f(true);e.preventDefault();});let h=apd(menu,null,null,"H");sa(h,"role","button");sa(h,"title","Toggle hold");sad(h,true);sas(h,false);ael(h,t,e=>{if (ch) {uh=!uh;sas(h,!uh);}e.preventDefault();});let e=apd(menu,null,null,"E");sa(e,"role","button");sa(e,"title","Control wave");sad(e,true);sas(e,false);ael(e,t,tcq=e=>{toggleController(status.current);if (e) e.preventDefault();});tcb=e;let d=apd(menu,null,null,"D");sa(d,"role","button");sa(d,"title","Toggle dark mode");sad(d,true);sas(d,false);let ds=v=>{let c=[];if (v) c.push("selected");if (!status.menuShowed) c.push("disabled");sc(d,c.join(" "));sas(d,v);document.getElementsByName("theme-color")[0].content=v?"#000":"#fff";};ds(status.dark);toggleDarkMode=()=>{let v=!status.dark;status.dark=v;ds(v);his.save();};ael(d,t,e=>{toggleDarkMode();e.preventDefault();});})();let ctrl=apd(body,"controller","hidden");let al=apd(ctrl,"axisLayer");let pt=apd(apd(ctrl,"pointLayer"));let gil=apd(ctrl,"graphInputLayer");(()=>{var a=apd(al);apd(a,null,null,"f");let Ft=apd(a,null,null);a=apd(al);apd(a,null,null,"λ");let Lt=apd(a,null,null);let tc=tcb;tcb=null;let t=status.touch?30:10;let adj=(F,L)=>{let x=Fp(F),y=Lp(L);ss(pt,`left:calc( ${x}% - ${t}px );right:calc( ${100-x}% - ${t}px );top:calc( ${y}% - ${t}px );bottom:calc( ${100-y}% - ${t}px );`);};let l=[];var to=null;toggleController=cu=>{if (status.controllerShowed) {l.length=0;if (to) {clearTimeout(to);to=null;}else {sc(ctrl,"hidden");status.controllerShowed=false;sas(tc,false);}}else {if (!cu) {if (status.lastMoved) cu=[status.lastMoved];else cu=[];}var F=0,L=0,eq=true;eq=cu.every(o=>{if (eq) {F=o.F,L=o.L,eq=false;return true;}else return (F==o.F)&&(L==o.L);});if (eq) {cu.forEach(o=>l.push(o));sc(pt);}else {F=0,L=0;cu.forEach(o=>{l.push(o);F+=o.F/cu.length;L+=o.L/cu.length;});sc(pt,"mixed");}if (l.length) {adj(F,L);Fv(F);Lv(L);let f=()=>{sc(ctrl);status.controllerShowed=true;sas(tc,true);to=null;};if (status.menuShowed) f();else {toggleMenu();to=setTimeout(f,500);}}}};let Fp=v=>(1+v)*50;let Lp=v=>(1-v)*50;let Fv=F=>Ft.textContent=`♩ = ${Math.round(Fw(F))}`;let Lv=L=>Lt.textContent=`${Math.round((3**L)*100)} %`;let move=e=>{let r=gil.getBoundingClientRect();let F=(Array.from(e).reduce((s,c)=>s+c.clientX/e.length,0)-r.left)/r.width*2-1;let L=1-(Array.from(e).reduce((s,c)=>s+c.clientY/e.length,0)-r.top)/r.height*2;adj(F,L);Ft.textContent=`♩ = ${Math.round(Fw(F))}`;Lt.textContent=`${Math.round((3**L)*100)} %`;sc(pt);l.forEach(o=>{o.F=F;o.L=L;});his.save();};if (status.touch) {ael(gil,"touchstart",e=>{move(e.changedTouches);e.preventDefault();});ael(gil,"touchmove",e=>{move(e.changedTouches);e.preventDefault();});let f=e=>{move(e.changedTouches);e.preventDefault();};ael(gil,"touchend",f);ael(gil,"touchcancel",f);}else {var valid=false;ael(gil,"mousedown",e=>{valid=true;move([e]);e.preventDefault();});ael(gil,"mousemove",e=>{if (valid) move([e]);e.preventDefault();});let f=e=>{if (valid) move([e]);valid=false;e.preventDefault();};ael(gil,"mouseup",f);ael(gil,"mouseout",f);}})();let startup=cd(null,null,status.touch?"Tap here":"Click here");var startupVisible=status.hold.length==0;if (startupVisible) ap(tl,startup);else status.hold.forEach(h=>h.oscillate());let removeStartup=()=>{if (startupVisible) {startupVisible=false;sc(tl,"hidden");setTimeout(()=>{sc(tl);rc(startup);},1000);}};ael(window,"load",()=>{html.replaceChild(body,document.body)});})();